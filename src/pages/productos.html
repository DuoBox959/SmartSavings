<!DOCTYPE html>
<html lang="es">
<head>
  <!-- üåê Configuraci√≥n b√°sica -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Gesti√≥n de Productos</title>

  <!-- üé® Estilos globales y espec√≠ficos -->
  <link rel="stylesheet" href="../style/global/header.css" />
  <link rel="stylesheet" href="../style/producto.css" />
  <link rel="stylesheet" href="../style/global/footer.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />

  <!-- üì¶ Librer√≠as JS -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script type="module" src="../functions/productos.js" defer></script>
</head>

<body>
  <!-- ‚úÖ Header din√°mico cargado por JS -->
  <div id="header"></div>

  <!-- üìö Navegaci√≥n por categor√≠as -->
  <nav class="nav-categorias">
    <ul>
      <li>
        <a href="#alimentacion">
          <i class="fas fa-utensils"></i><span>Alimentaci√≥n</span>
        </a>
      </li>
      <li>
        <a href="#drogueria">
          <i class="fas fa-briefcase-medical"></i><span>Droguer√≠a y salud</span>
        </a>
      </li>
      <li>
        <a href="#mascotas">
          <i class="fas fa-dog"></i><span>Mascotas</span>
        </a>
      </li>
    </ul>
  </nav>

  <!-- ‚ûï Bot√≥n para mostrar formulario de nuevo producto -->
  <button class="btn-agregar" onclick="mostrarFormularioAgregar()">Agregar Producto</button>

  <!-- üì¶ Contenedor de tarjetas de productos -->
  <div class="productos-container" id="productos-container"></div>

  <!-- üîô Bot√≥n para volver atr√°s -->
  <button class="back-button" onclick="volverAtras()">Volver Atr√°s</button>

  <!-- ‚úèÔ∏è MODAL: Editar Producto -->
  <div id="modal-editar" class="modal">
    <div class="modal-content">
      <span class="close" onclick="cerrarFormulario()">&times;</span>
      <h2>Editar Producto</h2>

      <form id="form-editar-producto">
        <!-- ‚úÖ Campos obligatorios -->
        <label>Nombre del producto: *</label>
        <input type="text" id="edit-nombre" required />

        <label>Tipo del producto: *</label>
        <select id="edit-tipo-select" onchange="toggleNuevoCampo('edit', 'tipo')" required>
          <option value="">Selecciona un tipo</option>
          <option value="nuevo">Otro (escribir nuevo)</option>
        </select>
        <input type="text" id="edit-tipo-nuevo" placeholder="Nuevo tipo" style="display: none;" />

        <label>Precio actual (‚Ç¨): *</label>
        <input type="number" id="edit-precio" step="0.01" required />

        <label>Peso: *</label>
        <input type="number" id="edit-peso" step="0.01" required />

        <label>Unidad de Peso: *</label>
        <select id="edit-unidadPeso" required>
          <option value="kg">Kilogramos (kg)</option>
          <option value="g">Gramos (g)</option>
          <option value="l">Litros (l)</option>
          <option value="ml">Mililitros (ml)</option>
        </select>

        <label>Supermercado: *</label>
        <select id="edit-supermercado-select" required onchange="toggleNuevoCampo('edit', 'supermercado')">
          <option value="">Selecciona un supermercado</option>
          <option value="nuevo">Otro (escribir nuevo)</option>
        </select>
        <input type="text" id="edit-supermercado-nuevo" placeholder="Nuevo supermercado" style="display: none;" />

        <label>Estado: *</label>
        <select id="edit-estado" required>
          <option value="En stock">En stock</option>
          <option value="Sin stock">Sin stock</option>
        </select>

        <!-- üîí Campos ocultos -->
        <input type="hidden" id="edit-producto-id" />
        <input type="hidden" id="edit-fecha-subida" />
        <input type="hidden" id="edit-usuario" />
        <input type="hidden" id="edit-fecha-actualizacion" />

        <!-- üîΩ Campos opcionales desplegables -->
        <details>
          <summary>Ver m√°s campos para tu producto</summary>

          <label>Imagen del producto:</label>
          <input type="file" id="add-imagen" name="Imagen" />
          <label>Ingredientes (separados por coma):</label>
          <input type="text" id="add-ingredientes" placeholder="Ej: az√∫car, agua, gas carb√≥nico" />
          
          <label>Marca:</label>
          <select id="edit-marca-select" onchange="toggleNuevoCampo('edit', 'marca')">
            <option value="">Selecciona una marca</option>
            <option value="nuevo">Otra (escribir nueva)</option>
          </select>
          <input type="text" id="edit-marca-nuevo" style="display: none;" />

          <label>Descripci√≥n del producto (Utilidad):</label>
          <input type="text" id="edit-utilidad" placeholder="Ej. Bebida refrescante y energizante" />

          <label>Ubicaci√≥n del supermercado:</label>
          <input type="text" id="edit-ubicacion-super" />

          <label>Ciudad del supermercado:</label>
          <input type="text" id="edit-ciudad-super" />

          <label>Pa√≠s del supermercado:</label>
          <input type="text" id="edit-pais-super" />

          <label>Proveedor:</label>
          <select id="edit-proveedor-select" onchange="toggleNuevoCampo('edit', 'proveedor')">
            <option value="">Selecciona un proveedor</option>
            <option value="nuevo">Otro (escribir nuevo)</option>
          </select>
          <input type="text" id="edit-proveedor-nuevo" style="display: none;" />

          <label>Pa√≠s del proveedor:</label>
          <input type="text" id="edit-pais-proveedor" />

          <label>Subtipo:</label>
          <select id="edit-subtipo-select" onchange="toggleNuevoCampo('edit', 'subtipo')">
            <option value="">Selecciona un subtipo</option>
            <option value="nuevo">Otro (escribir nuevo)</option>
          </select>
          <input type="text" id="edit-subtipo-nuevo" style="display: none;" />

          <label>Precio descuento (‚Ç¨):</label>
          <input type="number" id="edit-precioDescuento" step="0.01" />

          <label>Unidad/Lote:</label>
          <input type="number" id="edit-unidadLote" />

          <label>Precio por unidad/lote (‚Ç¨):</label>
          <input type="number" id="edit-precioPorUnidad" step="0.01" />

          <label>Precio Hist√≥rico:</label>
          <textarea id="edit-precioHistorico" rows="3" placeholder="Ejemplo: 10, 2023, 12, 2024"></textarea>
        </details>

        <!-- ‚úÖ Bot√≥n para guardar cambios -->
        <button type="button" onclick="guardarCambiosDesdeFormulario()">Guardar Cambios</button>
      </form>
    </div>
  </div>

  <!-- ‚ûï MODAL: Agregar nuevo producto -->
  <div id="modal-agregar" class="modal">
    <div class="modal-content">
      <span class="close" onclick="cerrarFormularioAgregar()">&times;</span>
      <h2>Agregar Producto</h2>

      <form id="form-agregar-producto">
        <label>Nombre del producto: *</label>
        <input type="text" id="add-nombre" required />

        <label>Tipo del producto: *</label>
        <select id="add-tipo-select" onchange="toggleNuevoCampo('add', 'tipo')" required>
          <option value="">Selecciona un tipo</option>
          <option value="nuevo">Otro (escribir nuevo)</option>
        </select>
        <input type="text" id="add-tipo-nuevo" style="display: none;" />

        <label>Precio actual (‚Ç¨): *</label>
        <input type="number" id="add-precio" step="0.01" required />

        <label>Peso: *</label>
        <input type="number" id="add-peso" step="0.01" required />

        <label>Unidad de Peso: *</label>
        <select id="add-unidadPeso" required>
          <option value="kg">Kilogramos</option>
          <option value="g">Gramos</option>
          <option value="l">Litros</option>
          <option value="ml">Mililitros</option>
        </select>

        <label>Supermercado: *</label>
        <select id="add-supermercado-select" onchange="toggleNuevoCampo('add', 'supermercado')" required>
          <option value="">Selecciona un supermercado</option>
          <option value="nuevo">Otro (escribir nuevo)</option>
        </select>
        <input type="text" id="add-supermercado-nuevo" style="display: none;" />

        <label>Estado: *</label>
        <select id="add-estado" required>
          <option value="En stock">En stock</option>
          <option value="Sin stock">Sin stock</option>
        </select>

        <!-- üîΩ Campos adicionales -->
        <details>
          <summary>Ver m√°s campos para tu producto</summary>

          <label>Imagen:</label>
          <input type="file" id="add-imagen" name="Imagen" />
          
          <label>Ingredientes (separados por coma):</label>
          <input type="text" id="add-ingredientes" placeholder="Ej: az√∫car, agua, gas carb√≥nico" />

          <label>Marca:</label>
          <select id="add-marca-select" onchange="toggleNuevoCampo('add', 'marca')">
            <option value="">Selecciona una marca</option>
            <option value="nuevo">Otra (escribir nueva)</option>
          </select>
          <input type="text" id="add-marca-nuevo" style="display: none;" />

          <label>Descripci√≥n del producto (Utilidad):</label>
          <input type="text" id="edit-utilidad" placeholder="Ej. Bebida refrescante y energizante" />
          
          <label>Ubicaci√≥n supermercado:</label>
          <input type="text" id="add-ubicacion-super" />

          <label>Ciudad del supermercado:</label>
          <input type="text" id="add-ciudad-super" />

          <label>Pa√≠s supermercado:</label>
          <input type="text" id="add-pais-super" />

          <label>Proveedor:</label>
          <select id="add-proveedor-select" onchange="toggleNuevoCampo('add', 'proveedor')">
            <option value="">Selecciona un proveedor</option>
            <option value="nuevo">Otro (escribir nuevo)</option>
          </select>
          <input type="text" id="add-proveedor-nuevo" style="display: none;" />

          <label>Pa√≠s proveedor:</label>
          <input type="text" id="add-pais-proveedor" />

          <label>Subtipo:</label>
          <select id="add-subtipo-select" onchange="toggleNuevoCampo('add', 'subtipo')">
            <option value="">Selecciona un subtipo</option>
            <option value="nuevo">Otro (escribir nuevo)</option>
          </select>
          <input type="text" id="add-subtipo-nuevo" style="display: none;" />

          <label>Precio descuento (‚Ç¨):</label>
          <input type="number" id="add-precioDescuento" step="0.01" />

          <label>Unidad/Lote:</label>
          <input type="number" id="add-unidadLote" />

          <label>Precio por unidad/lote (‚Ç¨):</label>
          <input type="number" id="add-precioPorUnidad" step="0.01" />

          <label>Precio Hist√≥rico:</label>
          <textarea id="add-precioHistorico" rows="3" placeholder="Ejemplo: 10, 2023, 12, 2024"></textarea>
        </details>

        <button type="button" onclick="guardarProductoNuevo()">Agregar Producto</button>
        <!-- ‚ùå Bot√≥n para cerrar el modal de agregar -->
        <button type="button" class="btn-cerrar" onclick="cerrarFormularioAgregar()">Cancelar</button>

      </form>
    </div>
  </div>

  <!-- ‚úÖ Footer din√°mico -->
  <div id="footer"></div>
</body>
</html>
